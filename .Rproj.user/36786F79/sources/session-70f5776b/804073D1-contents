library(emmeans)

# Obtain predicted probabilities for all reward × effort combinations
emm_effort_reward <- emmeans(final_model, ~ reward * effort, type = "response")
emm_effort_reward

library(dplyr)

df_long |> 
  group_by(reward, effort) |> 
  summarise(
    n_chosen = sum(choice == 1, na.rm = TRUE),   # assuming 1 = chosen, 0 = not chosen
    prop_chosen = mean(choice == 1, na.rm = TRUE)
  ) 


library(emmeans)
emm_effort_reward <- emmeans(final_model, ~ reward * effort, type = "response")

emmip(final_model, effort ~ reward, type = "response") +
  labs(
    title = "Reward × Effort interaction",
    x = "Reward level",
    y = "Predicted probability of choosing option"
  ) +
  theme_minimal()


emmip(final_model, group ~ block | target, type = "response") +
  labs(
    title = "Target × Group × Block interaction",
    x = "Block",
    y = "Predicted probability of choosing option"
  ) +
  theme_minimal()



emm_target_group_block <- emmeans(
  final_model,
  ~ target * group * block,
  type = "response"
)
emm_target_group_block


emmip(final_model, group ~ block | target, type = "response") +
  labs(
    title = "Target × Group × Block interaction",
    x = "Block",
    y = "Predicted probability of choosing option"
  ) +
  theme_minimal()
