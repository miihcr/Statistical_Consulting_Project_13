"0",""
"0","# --- Create Plots --- "
"0","df_summary <- df_long |> "
"0","  mutate("
"0","    # Create nice labels"
"0","    target_label = factor(target, "
"0","                          levels = c(""self"", ""climate"", ""prosocial""),"
"0","                          labels = c(""Self"", ""Climate"", ""Prosocial"")),"
"0","    effort_label = factor(effort,"
"0","                          levels = c(""40"", ""90""),"
"0","                          labels = c(""40%"", ""90%"")),"
"0","    reward_label = factor(reward,"
"0","                          levels = c(2, 6, 10),"
"0","                          labels = c(""2 coins"", ""6 coins"", ""10 coins""))"
"0","  )"
"0",""
"0","a_data <- df_summary |> "
"0","  group_by(target_label) |> "
"0","  summarise("
"0","    prop = mean(choice, na.rm = TRUE),"
"0","    se = sqrt(prop * (1 - prop) / n()),"
"0","    n = n(),"
"0","    .groups = ""drop"""
"0","  )"
"0",""
"0","b_data <- df_summary |> "
"0","  group_by(effort_label) |> "
"0","  summarise("
"0","    prop = mean(choice, na.rm = TRUE),"
"0","    se = sqrt(prop * (1 - prop) / n()),"
"0","    n = n(),"
"0","    .groups = ""drop"""
"0","  )"
"0",""
"0","c_data <- df_summary |> "
"0","  group_by(reward_label) |> "
"0","  summarise("
"0","    prop = mean(choice, na.rm = TRUE),"
"0","    se = sqrt(prop * (1 - prop) / n()),"
"0","    n = n(),"
"0","    .groups = ""drop"""
"0","  )"
"0",""
"0","# --- Plot A: proportion by recipient"
"0","plot_a <- ggplot(a_data,"
"0","                 aes(x = reorder(target_label, -prop),"
"0","                     y = prop,"
"0","                     fill = target_label)) +"
"0","  geom_bar(stat = ""identity"", width = 0.6) +"
"0","  geom_errorbar(aes(ymin = prop - se, ymax = prop + se),"
"0","                width = 0.15, linewidth = 0.8) +"
"0","  geom_text(aes(label = scales::percent(prop, accuracy = 1)), "
"0","            vjust = -0.8) +"
"0","  scale_fill_manual("
"0","    name = ""Social target"","
"0","    values = c(""Self"" = ""#E15759"",      "
"0","               ""Climate"" = ""#59A14F"",    "
"0","               ""Prosocial"" = ""#4E79A7"")  "
"0","  ) +"
"0","  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +"
"0","  labs("
"0","    x = ""Recipient"","
"0","    y = ""Proportion of High-Effort Choices"","
"0","    fill = ""Social target"""
"0","  ) +"
"0","  theme_minimal()"
"0",""
"0","plot_a "
