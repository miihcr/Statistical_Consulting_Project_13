"0",""
"0",""
"0","# Control"
"0","ctrl <- glmerControl(optimizer = ""bobyqa"", optCtrl = list(maxfun = 1e6))"
"0",""
"0","# --- Random intercepts: ppn + class vs ppn only ---"
"0","m1 <- glmer("
"0","  choice ~ target*group*block + reward*effort + school +"
"0","    (1 | ppn) + (1 | class),"
"0","  data = df_long, family = binomial, control = ctrl"
"0",")"
"0",""
"0","isSingular(m1)"
"1","[1]"
"1"," TRUE"
"1","
"
"0","VarCorr(m1)"
"1",""
"1"," Groups"
"1"," Name       "
"1"," Std.Dev."
"1","
"
"1"," ppn   "
"1"," (Intercept)"
"1"," 1.4365  "
"1","
"
"1"," class "
"1"," (Intercept)"
"1"," 0.0000  "
"1","
"
"0","m1_simpler <- glmer("
"0","  choice ~ target*group*block + reward*effort + school +"
"0","    (1 | ppn),"
"0","  data = df_long, family = binomial, control = ctrl"
"0",")"
"0","anova(m1_simpler, m1, test = ""Chisq"")  # keep class only if significant & non-singular"
"1","Data: df_long"
"1","
"
"1","Models:"
"1","
"
"1","m1_simpler: choice ~ target * group * block + reward * effort + school + (1 | ppn)"
"1","
"
"1","m1: choice ~ target * group * block + reward * effort + school + (1 | ppn) + (1 | class)"
"1","
"
"1","          "
"1"," npar"
"1","    AIC"
"1","    BIC"
"1","  logLik"
"1"," -2*log(L)"
"1"," Chisq"
"1"," Df"
"1"," Pr(>Chisq)"
"1","
m1_simpler"
"1","   26"
"1"," 2556.5"
"1"," 2730.1"
"1"," -1252.2"
"1","    2504.5"
"1","      "
"1","   "
"1","           "
"1","
m1        "
"1","   27"
"1"," 2558.5"
"1"," 2738.8"
"1"," -1252.2"
"1","    2504.5"
"1","     0"
"1","  1"
"1","     0.9998"
"1","
"
"0","# --- Add slopes (|) ---"
"0","m2 <- glmer("
"0","  choice ~ target*group*block + reward*effort + school +"
"0","    (1 + block | ppn),"
"0","  data = df_long, family = binomial, control = ctrl"
"0",")"
"0","isSingular(m2)"
"1","[1]"
"1"," FALSE"
"1","
"
"0","VarCorr(m2)"
"1",""
"1"," Groups"
"1"," Name       "
"1"," Std.Dev."
"1"," Corr "
"1","
"
"1"," ppn   "
"1"," (Intercept)"
"1"," 1.2518  "
"1","      "
"1","
"
"1","       "
"1"," blockpost  "
"1"," 2.2585  "
"1"," 0.241"
"1","
"
"0","anova(m1_simpler, m2, test = ""Chisq"")"
"1","Data: df_long"
"1","
"
"1","Models:"
"1","
"
"1","m1_simpler: choice ~ target * group * block + reward * effort + school + (1 | ppn)"
"1","
"
"1","m2: choice ~ target * group * block + reward * effort + school + (1 + block | ppn)"
"1","
"
"1","          "
"1"," npar"
"1","    AIC"
"1","    BIC"
"1","  logLik"
"1"," -2*log(L)"
"1","  Chisq"
"1"," Df"
"1"," Pr(>Chisq)"
"1","    "
"1","
m1_simpler"
"1","   26"
"1"," 2556.5"
"1"," 2730.1"
"1"," -1252.2"
"1","    2504.5"
"1","       "
"1","   "
"1","           "
"1","    "
"1","
m2        "
"1","   28"
"1"," 2456.0"
"1"," 2643.0"
"1"," -1200.0"
"1","    2400.0"
"1"," 104.44"
"1","  2"
"1","  < 2.2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"0","final_model <- m2"
"0",""
"0","Anova(final_model, type = 3)"
"1","Analysis of Deviance Table (Type III Wald chisquare tests)
"
"1","
"
"1","Response: choice"
"1","
"
"1","                  "
"1","    Chisq"
"1"," Df"
"1"," Pr(>Chisq)"
"1","    "
"1","
(Intercept)       "
"1","  49.0353"
"1","  1"
"1","  2.514e-12"
"1"," ***"
"1","
target            "
"1","   0.3754"
"1","  2"
"1","  0.8288811"
"1","    "
"1","
group             "
"1","   1.2859"
"1","  2"
"1","  0.5257520"
"1","    "
"1","
block             "
"1","  14.9032"
"1","  1"
"1","  0.0001132"
"1"," ***"
"1","
reward            "
"1","  24.3328"
"1","  2"
"1","  5.202e-06"
"1"," ***"
"1","
effort            "
"1"," 106.3724"
"1","  1"
"1","  < 2.2e-16"
"1"," ***"
"1","
school            "
"1","  10.0250"
"1","  2"
"1","  0.0066544"
"1"," ** "
"1","
target:group      "
"1","   5.6654"
"1","  4"
"1","  0.2255671"
"1","    "
"1","
target:block      "
"1","   0.4641"
"1","  2"
"1","  0.7929005"
"1","    "
"1","
group:block       "
"1","   3.1423"
"1","  2"
"1","  0.2078111"
"1","    "
"1","
reward:effort     "
"1","  13.9804"
"1","  2"
"1","  0.0009209"
"1"," ***"
"1","
target:group:block"
"1","   5.8369"
"1","  4"
"1","  0.2116633"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"0","summary(final_model)"
"1","Generalized linear mixed model fit by maximum likelihood (Laplace"
"1",""
"1","
"
"1","  Approximation)"
"1",""
"1"," ["
"1",""
"1","glmerMod"
"1",""
"1","]"
"1","
"
"1"," Family:"
"1"," "
"1","binomial"
"1"," "
"1"," ( logit )"
"1","
"
"1","Formula:"
"1"," "
"1","choice ~ target * group * block + reward * effort + school + "
"1"," "
"1","
"
"1","    (1 + block | ppn)"
"1","
"
"1","   Data:"
"1"," "
"1","df_long"
"1","
"
"1","Control:"
"1"," "
"1","ctrl"
"1","
"
"1","
"
"1","      AIC "
"1","      BIC "
"1","   logLik "
"1","-2*log(L) "
"1"," df.resid "
"1","
"
"1","     2456 "
"1","     2643 "
"1","    -1200 "
"1","     2400 "
"1","     5848 "
"1","
"
"1","
"
"1","Scaled residuals:"
"1"," "
"1","
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-9.9109 "
"1"," 0.0422 "
"1"," 0.1155 "
"1"," 0.2311 "
"1"," 3.2089 "
"1","
"
"1","
"
"1","Random effects:
"
"1",""
"1"," Groups"
"1"," Name       "
"1"," Variance"
"1"," Std.Dev."
"1"," Corr"
"1","
"
"1"," ppn   "
"1"," (Intercept)"
"1"," 1.567   "
"1"," 1.252   "
"1","     "
"1","
"
"1","       "
"1"," blockpost  "
"1"," 5.101   "
"1"," 2.259   "
"1"," 0.24"
"1","
"
"1","Number of obs: 5876, groups: "
"1"," "
"1","ppn, 164"
"1","
"
"1","
Fixed effects:
"
"1","                                            "
"1"," Estimate"
"1"," Std. Error"
"1"," z value"
"1","
(Intercept)                                 "
"1","  2.93982"
"1","    0.41982"
"1","   7.003"
"1","
targetclimate                               "
"1"," -0.04222"
"1","    0.29039"
"1","  -0.145"
"1","
targetprosocial                             "
"1","  0.13249"
"1","    0.29716"
"1","   0.446"
"1","
grouppositive_norm                          "
"1","  0.40203"
"1","    0.40895"
"1","   0.983"
"1","
groupnegative_norm                          "
"1","  0.39037"
"1","    0.41108"
"1","   0.950"
"1","
blockpost                                   "
"1","  2.41732"
"1","    0.62617"
"1","   3.860"
"1","
reward6 coins                               "
"1","  0.83441"
"1","    0.23955"
"1","   3.483"
"1","
reward10 coins                              "
"1","  1.16268"
"1","    0.26036"
"1","   4.466"
"1","
effort90%                                   "
"1"," -1.83031"
"1","    0.17746"
"1"," -10.314"
"1","
school1_loc2                                "
"1"," -0.37974"
"1","    0.36288"
"1","  -1.046"
"1","
school2                                     "
"1","  0.53721"
"1","    0.36383"
"1","   1.477"
"1","
targetclimate:grouppositive_norm            "
"1"," -0.12090"
"1","    0.43954"
"1","  -0.275"
"1","
targetprosocial:grouppositive_norm          "
"1"," -0.90753"
"1","    0.42829"
"1","  -2.119"
"1","
targetclimate:groupnegative_norm            "
"1"," -0.01427"
"1","    0.44398"
"1","  -0.032"
"1","
targetprosocial:groupnegative_norm          "
"1"," -0.29649"
"1","    0.44463"
"1","  -0.667"
"1","
targetclimate:blockpost                     "
"1"," -0.25486"
"1","    0.47394"
"1","  -0.538"
"1","
targetprosocial:blockpost                   "
"1"," -0.30496"
"1","    0.48093"
"1","  -0.634"
"1","
grouppositive_norm:blockpost                "
"1","  0.75917"
"1","    0.81622"
"1","   0.930"
"1","
groupnegative_norm:blockpost                "
"1"," -0.69915"
"1","    0.74064"
"1","  -0.944"
"1","
reward6 coins:effort90%                     "
"1","  0.97525"
"1","    0.29570"
"1","   3.298"
"1","
reward10 coins:effort90%                    "
"1","  0.87020"
"1","    0.31772"
"1","   2.739"
"1","
targetclimate:grouppositive_norm:blockpost  "
"1"," -1.29121"
"1","    0.76895"
"1","  -1.679"
"1","
targetprosocial:grouppositive_norm:blockpost"
"1"," -0.48070"
"1","    0.76640"
"1","  -0.627"
"1","
targetclimate:groupnegative_norm:blockpost  "
"1","  0.56262"
"1","    0.71078"
"1","   0.792"
"1","
targetprosocial:groupnegative_norm:blockpost"
"1","  0.54922"
"1","    0.70768"
"1","   0.776"
"1","
"
"1","                                            "
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)                                 "
"1"," 2.51e-12"
"1"," ***"
"1","
targetclimate                               "
"1"," 0.884391"
"1","    "
"1","
targetprosocial                             "
"1"," 0.655711"
"1","    "
"1","
grouppositive_norm                          "
"1"," 0.325572"
"1","    "
"1","
groupnegative_norm                          "
"1"," 0.342305"
"1","    "
"1","
blockpost                                   "
"1"," 0.000113"
"1"," ***"
"1","
reward6 coins                               "
"1"," 0.000495"
"1"," ***"
"1","
reward10 coins                              "
"1"," 7.98e-06"
"1"," ***"
"1","
effort90%                                   "
"1","  < 2e-16"
"1"," ***"
"1","
school1_loc2                                "
"1"," 0.295343"
"1","    "
"1","
school2                                     "
"1"," 0.139802"
"1","    "
"1","
targetclimate:grouppositive_norm            "
"1"," 0.783264"
"1","    "
"1","
targetprosocial:grouppositive_norm          "
"1"," 0.034092"
"1"," *  "
"1","
targetclimate:groupnegative_norm            "
"1"," 0.974360"
"1","    "
"1","
targetprosocial:groupnegative_norm          "
"1"," 0.504877"
"1","    "
"1","
targetclimate:blockpost                     "
"1"," 0.590756"
"1","    "
"1","
targetprosocial:blockpost                   "
"1"," 0.526011"
"1","    "
"1","
grouppositive_norm:blockpost                "
"1"," 0.352319"
"1","    "
"1","
groupnegative_norm:blockpost                "
"1"," 0.345176"
"1","    "
"1","
reward6 coins:effort90%                     "
"1"," 0.000973"
"1"," ***"
"1","
reward10 coins:effort90%                    "
"1"," 0.006165"
"1"," ** "
"1","
targetclimate:grouppositive_norm:blockpost  "
"1"," 0.093118"
"1"," .  "
"1","
targetprosocial:grouppositive_norm:blockpost"
"1"," 0.530515"
"1","    "
"1","
targetclimate:groupnegative_norm:blockpost  "
"1"," 0.428622"
"1","    "
"1","
targetprosocial:groupnegative_norm:blockpost"
"1"," 0.437695"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
