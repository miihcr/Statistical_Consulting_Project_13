sus_scores <- df_wide |>
select(starts_with("SUS_"))
# Descriptives
mean(df_wide$susceptibility, na.rm = TRUE)
sd(df_wide$susceptibility, na.rm = TRUE)
range(df_wide$susceptibility, na.rm = TRUE)
# Reliability
alpha(sus_scores)  # Cronbach's alpha
sus_scores
sus_scores <- df_wide |>
select(starts_with("SUS_"))
sus_scores
# Descriptives
mean(df_wide$susceptibility, na.rm = TRUE)
sd(df_wide$susceptibility, na.rm = TRUE)
range(df_wide$susceptibility, na.rm = TRUE)
# Reliability
alpha(sus_scores, na.rm = TRUE) # alpha
?alpha
library(psych)
library(psych)
sus_scores <- df_wide |>
select(starts_with("SUS_"))
sus_scores
# Descriptives
mean(df_wide$susceptibility, na.rm = TRUE)
sd(df_wide$susceptibility, na.rm = TRUE)
range(df_wide$susceptibility, na.rm = TRUE)
# Reliability
alpha(sus_scores, na.rm = TRUE) # alpha
?alpha
# Reliability
alpha(sus_scores, use = "pairwise.complete.obs") # alpha
# Reliability
alpha(sus_scores,
use = "pairwise.complete.obs") # alpha
# Reliability
alpha(sus_scores)# alpha
# Reliability
alpha(sus_scores)# alpha
str(sus_scores)
View(sus_scores)
View(df_wide)
str(sus_scores)
head(sus_scores)
library(psych)
alpha(sus_scores, na.rm = TRUE)
alpha(sus_scores, use = "pairwise")
sus_clean <- na.omit(sus_scores)
alpha(sus_clean)
sus_scores <- df_wide |>
select(starts_with("SUS_"), as.numeric)
sus_scores <- df_wide |>
select(starts_with("SUS_")) |>
mutate(across(everything(), as.numeric))
sus_scores
str(sus_scores)
# Descriptives
mean(df_wide$susceptibility, na.rm = TRUE)
sd(df_wide$susceptibility, na.rm = TRUE)
range(df_wide$susceptibility, na.rm = TRUE)
# Reliability
alpha(sus_scores)# alpha
str(sus_scores)
# Reliability
alpha(sus_scores, use = "pairwise")# alpha
library(psych)
# Reliability
alpha(sus_scores, use = "pairwise")# alpha
?alpha
# Reliability
psych::alpha(sus_scores, use = "pairwise")# alpha
psych::omega(sus_scores) # omega
psych::omega(sus_scores, use = "pairwise") # omega
describe(sus_scores)
SUS_total <- rowMeans(sus_scores, na.rm=TRUE)*8
describe(SUS_total)
SUS_total <- rowMeans(sus_scores, na.rm=TRUE)
describe(SUS_total)
SUS_total <- rowMeans(sus_scores, na.rm=TRUE)
describe(SUS_total)
hist(SUS_total)
library(lavaan)
'
fit1 <- cfa(model, data = sus_scores, std.lv = TRUE)
summary(fit, fit.measures = TRUE, standardized = TRUE)
summary(fit1, fit.measures = TRUE, standardized = TRUE)
library(lavaan)
colSums(is.na(sus_scores))
fit1 <- cfa(model, data = sus_scores, std.lv = TRUE,
missing = "fiml")
summary(fit1, fit.measures = TRUE, standardized = TRUE)
0
model <- '
SUS =~ SUS_1 + SUS_2 + SUS_3 + SUS_4 + SUS_5 + SUS_6 + SUS_7 + SUS_8
'
model <- '
SUS =~ SUS_1 + SUS_2 + SUS_3 + SUS_4 + SUS_5 + SUS_6 + SUS_7 + SUS_8
'
'
model <- '
SUS =~ SUS_1 + SUS_2 + SUS_3 + SUS_4 + SUS_5 + SUS_6 + SUS_7 + SUS_8
'
fit1 <- cfa(
model,
data = sus_scores,
std.lv = TRUE,
missing = "fiml"
)
summary(fit1, fit.measures = TRUE, standardized = TRUE)
?cfa
summary(fit1, fit.measures = TRUE, standardized = TRUE)
summary(fit1, fit.measures = TRUE, standardized = TRUE)
model2 <- '
Anxiety =~ SUS_1 + SUS_3 + SUS_5 + SUS_7
Selfesteem =~ SUS_2 + SUS_4 + SUS_6 + SUS_8
'
# Single factor model
model2 <- '
Anxiety =~ SUS_1 + SUS_3 + SUS_5 + SUS_7
Selfesteem =~ SUS_2 + SUS_4 + SUS_6 + SUS_8
'
fit2 <- cfa(
model2,
data = sus_scores,
std.lv = TRUE,
missing = "fiml"
)
summary(fit2, fit.measures = TRUE, standardized = TRUE)
# Function to extract key fit indices
fit_table <- function(fit) {
data.frame(
ChiSq = fitMeasures(fit, "chisq"),
df    = fitMeasures(fit, "df"),
CFI   = fitMeasures(fit, "cfi"),
TLI   = fitMeasures(fit, "tli"),
RMSEA = fitMeasures(fit, "rmsea"),
SRMR  = fitMeasures(fit, "srmr")
)
}
fit_table
fit_table(fit1)
fit_table(fit)
fit_table(fit2)
fit_table(fit1)
fit_table(fit1)
fit_table(fit2)
summary(fit1, fit.measures = TRUE, standardized = TRUE)
fit_table(fit1)
summary(fit1, fit.measures = TRUE, standardized = TRUE)
summary(fit2, fit.measures = TRUE, standardized = TRUE)
# --- Reliability (α and Omega) ---
alpha_omega <- function(data, items) {
a <- psych::alpha(data[, items])$total$raw_alpha
o <- psych::omega(data[, items], nfactors = 1, plot = FALSE)$omega.tot
c(alpha = a, omega = o)
}
# Collect tables
one_factor_fit  <- fit_indices(fit1)
# --- Fit statistics ---
fit_indices <- function(fit) {
c(
ChiSq  = fitMeasures(fit, "chisq"),
df     = fitMeasures(fit, "df"),
CFI    = fitMeasures(fit, "cfi"),
TLI    = fitMeasures(fit, "tli"),
RMSEA  = fitMeasures(fit, "rmsea"),
SRMR   = fitMeasures(fit, "srmr")
)
}
# --- Reliability (α and Omega) ---
alpha_omega <- function(data, items) {
a <- psych::alpha(data[, items])$total$raw_alpha
o <- psych::omega(data[, items], nfactors = 1, plot = FALSE)$omega.tot
c(alpha = a, omega = o)
}
# Collect tables
one_factor_fit  <- fit_indices(fit1)
two_factor_fit  <- fit_indices(fit2)
# Reliability (using all 8 SUS items)
rel <- alpha_omega(sus_scores, paste0("SUS_", 1:8))
# Final table
results <- rbind(
"SUS (One-factor)" = c(one_factor_fit,  rel),
"SUS (Two-factor)" = c(two_factor_fit,  rel)
)
round(results, 3)
# --- Fit statistics ---
fit_indices <- function(fit) {
c(
ChiSq  = fitMeasures(fit, "chisq"),
df     = fitMeasures(fit, "df"),
CFI    = fitMeasures(fit, "cfi"),
TLI    = fitMeasures(fit, "tli"),
RMSEA  = fitMeasures(fit, "rmsea"),
SRMR   = fitMeasures(fit, "srmr"),
p      = fitMeasures(fit, "pvalue")
)
}
# --- Reliability (α and Omega) ---
alpha_omega <- function(data, items) {
a <- psych::alpha(data[, items])$total$raw_alpha
o <- psych::omega(data[, items], nfactors = 1, plot = FALSE)$omega.tot
c(alpha = a, omega = o)
}
# Collect tables
one_factor_fit  <- fit_indices(fit1)
two_factor_fit  <- fit_indices(fit2)
# Reliability (using all 8 SUS items)
rel <- alpha_omega(sus_scores, paste0("SUS_", 1:8))
# Final table
results <- rbind(
"SUS (One-factor)" = c(one_factor_fit,  rel),
"SUS (Two-factor)" = c(two_factor_fit,  rel)
)
round(results, 3)
summary(fit1, fit.measures = TRUE, standardized = TRUE)
round(results, 3)
# Reliability
psych::alpha(sus_scores, use = "pairwise")# alpha
# Reliability
psych::alpha(sus_scores, use = "pairwise")$alpha# alpha
$alpha
# Reliability
psych::alpha(sus_scores, use = "pairwise")# alpha
psych::alpha(sus_scores, use = "pairwise")
psych::omega(sus_scores, use = "pairwise")
psych::omega(sus_scores, use = "pairwise")$omegatotal
names(psych::omega(sus_scores, use = "pairwise"))
psych::omega(sus_scores, use = "pairwise")$omega.tot
names(psych::alpha(sus_scores, use = "pairwise"))
# Reliability
psych::alpha(sus_scores, use = "pairwise")$total# alpha
reliability(fit2)
round(results, 3)
round(results, 2)
round(results, 3)
# Choice rates by reward level
df_long |>
group_by(reward) |>
summarise(
mean_choice = mean(choice, na.rm = TRUE),
sd_choice = sd(choice, na.rm = TRUE)
)
# Choice rates by effort level
df_long |>
group_by(effort) |>
summarise(
mean_choice = mean(choice, na.rm = TRUE),
sd_choice = sd(choice, na.rm = TRUE)
)
# Reward × Effort interaction pattern
df_long |>
group_by(reward, effort) |>
summarise(
mean_choice = mean(choice, na.rm = TRUE),
sd_choice = sd(choice, na.rm = TRUE)
)
# By participant overall
ceiling_participants <- df_long |>
group_by(ppn) |>
summarise(
prop_high_effort = mean(choice, na.rm = TRUE)
) |>
summarise(
at_90 = sum(prop_high_effort >= 0.90),
pct_90 = mean(prop_high_effort >= 0.90) * 100,
at_95 = sum(prop_high_effort >= 0.95),
pct_95 = mean(prop_high_effort >= 0.95) * 100,
at_100 = sum(prop_high_effort == 1.00),
pct_100 = mean(prop_high_effort == 1.00) * 100
)
print(ceiling_participants)
# By participant and block
ceiling_by_block <- df_long |>
group_by(ppn, block) |>
summarise(
prop_high_effort = mean(choice, na.rm = TRUE),
.groups = "drop"
) |>
group_by(block) |>
summarise(
n_at_90 = sum(prop_high_effort >= 0.90),
pct_at_90 = mean(prop_high_effort >= 0.90) * 100,
n_at_95 = sum(prop_high_effort >= 0.95),
pct_at_95 = mean(prop_high_effort >= 0.95) * 100,
n_at_100 = sum(prop_high_effort == 1.00),
pct_at_100 = mean(prop_high_effort == 1.00) * 100
)
print(ceiling_by_block)
# Calculate proportion of high-effort choices per participant
participant_props <- df_long |>
group_by(ppn) |>
summarise(
prop_high_effort = mean(choice, na.rm = TRUE)
)
# Descriptives
summary(participant_props$prop_high_effort)
quantile(participant_props$prop_high_effort, probs = c(0.25, 0.5, 0.75))
# How many chose high effort 100% of the time?
sum(participant_props$prop_high_effort == 1.0)
mean(participant_props$prop_high_effort == 1.0) * 100
# Histogram
ggplot(participant_props, aes(x = prop_high_effort)) +
geom_histogram(binwidth = 0.05, fill = "steelblue", color = "white") +
scale_x_continuous(limits = c(0, 1),
breaks = seq(0, 1, 0.1),
labels = scales::percent) +
labs(x = "Proportion of high-effort choices",
y = "Number of participants",
title = "Distribution of High-Effort Choice Rates Across Participants") +
theme_minimal() +
geom_vline(xintercept = 0.90, linetype = "dashed", color = "red") +
annotate("text", x = 0.85, y = max(table(cut(participant_props$prop_high_effort, breaks = 20))),
label = "90% threshold", color = "red")
# Standard deviation of choices (within-person)
within_person_variability <- df_long|>
group_by(ppn)|>
summarise(
sd_choice = sd(choice, na.rm = TRUE),
var_choice = var(choice, na.rm = TRUE)
)|>
summarise(
mean_sd = mean(sd_choice, na.rm = TRUE),
median_sd = median(sd_choice, na.rm = TRUE),
n_zero_var = sum(sd_choice == 0, na.rm = TRUE),
pct_zero_var = mean(sd_choice == 0, na.rm = TRUE) * 100
)
print(within_person_variability)
# Calculate the "usable" range
participant_props %>%
summarise(
min = min(prop_high_effort),
max = max(prop_high_effort),
range = max - min,
mean = mean(prop_high_effort),
sd = sd(prop_high_effort)
)
# Percentage of theoretical maximum range being used
theoretical_range <- 1.0 - 0.0  # 0 to 1
observed_range <- max(participant_props$prop_high_effort) - min(participant_props$prop_high_effort)
range_restriction <- (observed_range / theoretical_range) * 100
print(paste0("Observed range uses ", round(range_restriction, 1), "% of theoretical range"))
# Calculate participant-level proportions
participant_props <- df_long %>%
group_by(ppn, group) %>%
summarise(
prop_high_effort = mean(choice, na.rm = TRUE),
.groups = "drop"
)
# Histogram by group
ggplot(participant_props, aes(x = prop_high_effort, fill = group)) +
geom_histogram(binwidth = 0.05, color = "white", alpha = 0.7, position = "identity") +
scale_x_continuous(limits = c(0, 1),
breaks = seq(0, 1, 0.1),
labels = scales::percent) +
scale_fill_manual(values = c("control" = "gray50",
"positive_norm" = "#2E7D32",
"negative_norm" = "#C62828"),
name = "Condition") +
labs(x = "Proportion of high-effort choices per participant",
y = "Number of participants",
title = "Strong Ceiling Effect Across All Conditions") +
theme_minimal(base_size = 12) +
theme(legend.position = "bottom") +
geom_vline(xintercept = 0.90, linetype = "dashed", color = "black", linewidth = 0.8) +
annotate("text", x = 0.75, y = Inf, vjust = 1.5,
label = "90% threshold", size = 3.5)
# Calculate participant-level proportions
participant_props <- df_long %>%
group_by(ppn, group) %>%
summarise(
prop_high_effort = mean(choice, na.rm = TRUE),
.groups = "drop"
)
# Histogram by group
ggplot(participant_props, aes(x = prop_high_effort, fill = group)) +
geom_histogram(binwidth = 0.05, color = "white", alpha = 0.7, position = "identity") +
scale_x_continuous(limits = c(0, 1),
breaks = seq(0, 1, 0.1),
labels = scales::percent) +
scale_fill_manual(values = c("control" = "gray50",
"positive_norm" = "#2E7D32",
"negative_norm" = "#C62828"),
name = "Condition") +
labs(x = "Proportion of high-effort choices per participant",
y = "Number of participants",
title = "Strong Ceiling Effect Across All Conditions") +
theme_minimal(base_size = 12) +
theme(legend.position = "bottom") +
geom_vline(xintercept = 0.90, linetype = "dashed", color = "black", linewidth = 0.8) +
annotate("text", x = 0.75, y = Inf, vjust = 1.5,
label = "90% threshold", size = 3.5)
# table
ceiling_summary <- df_long |>
group_by(ppn)|>
summarise(
prop = mean(choice, na.rm = TRUE),
sd = sd(choice, na.rm = TRUE)
)|>
summarise(
mean = mean(prop),
sd = sd(prop),
median = median(prop),
q25 = quantile(prop, 0.25),
q75 = quantile(prop, 0.75),
min = min(prop),
max = max(prop),
n_90 = sum(prop >= 0.90),
pct_90 = mean(prop >= 0.90) * 100,
n_95 = sum(prop >= 0.95),
pct_95 = mean(prop >= 0.95) * 100,
n_100 = sum(prop == 1.00),
pct_100 = mean(prop == 1.00) * 100,
mean_within_sd = mean(sd, na.rm = TRUE),
n_zero_var = sum(sd == 0, na.rm = TRUE),
pct_zero_var = mean(sd == 0, na.rm = TRUE) * 100
)
print(ceiling_summary)
plot_b_data <- df_long |>
group_by(group, block, target) |>
summarise(
p_choice = mean(choice == 1, na.rm = TRUE),
n       = sum(!is.na(choice)),
.groups = "drop"
)
target_block_group_plot <- ggplot(plot_b_data,
aes(x = block,
y = p_choice,
color = target,
group = target)) +
geom_point(size = 3) +
geom_line(size = 1) +
facet_wrap(~ group, labeller = labeller(group = group_labels)) +
labs(
x     = "Block",
y     = "Proportion of High-Effort Choices",
color = "Target"
) +
scale_y_continuous(limits = c(0, 1)) +
scale_color_manual(values = pal_target) +
theme_bw() +
theme(
legend.position = "top",
legend.title    = element_blank()
)
target_block_group_plot
plot_a_data <- df_long |>
group_by(reward, effort) |>
summarise(p = mean(choice == 1, na.rm = TRUE), .groups = "drop")
reward_effort_plot <- reward_effort_summary |>
ggplot(aes(x = reward, y = p, color = effort, group = effort)) +
geom_point(size = 3) +
geom_line(size = 1) +
scale_color_manual(values = c(
"40%" = "#E15759",
"90%" = "#4E79A7"
)) +
scale_y_continuous(limits = c(0, 1)) +
labs(
x = "Reward",
y = "Proportion of High-Effort Choices",
color = "Effort"
) +
theme_bw()
plot_a_data <- df_long |>
group_by(reward, effort) |>
summarise(p = mean(choice == 1, na.rm = TRUE), .groups = "drop")
reward_effort_plot <- plot_a_data |>
ggplot(aes(x = reward, y = p, color = effort, group = effort)) +
geom_point(size = 3) +
geom_line(size = 1) +
scale_color_manual(values = c(
"40%" = "#E15759",
"90%" = "#4E79A7"
)) +
scale_y_continuous(limits = c(0, 1)) +
labs(
x = "Reward",
y = "Proportion of High-Effort Choices",
color = "Effort"
) +
theme_bw()
reward_effort_plot
plot_b_data <- df_long |>
group_by(group, block, target) |>
summarise(
p_choice = mean(choice == 1, na.rm = TRUE),
n       = sum(!is.na(choice)),
.groups = "drop"
)
target_block_group_plot <- plot_b_data |>
ggplot(aes(x = block,
y = p_choice,
color = target,
group = target)) +
geom_point(size = 3) +
geom_line(size = 1) +
facet_wrap(~ group, labeller = labeller(group = group_labels)) +
labs(
x     = "Block",
y     = "Proportion of High-Effort Choices",
color = "Target"
) +
scale_y_continuous(limits = c(0, 1)) +
scale_color_manual(values = pal_target) +
theme_bw() +
theme(
legend.position = "top",
legend.title    = element_blank()
)
target_block_group_plot
